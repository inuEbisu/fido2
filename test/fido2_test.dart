import 'package:fido2/fido2.dart';
import 'package:test/test.dart';

void main() {
  group('Info', () {
    test('Request', () {
      var makeGetInfoRequest = Ctap2.makeGetInfoRequest();
      expect(makeGetInfoRequest, equals([4]));
    });

    test('Response', () {
      var response = hexStringToList('AD0183665532465F5632684649444F5F325F30684649444F5F325F3102846863726564426C6F626B6372656450726F746563746B686D61632D7365637265746C6C61726765426C6F624B65790350244EB29EE0904E4981FE1F20F8D3B8F404A662726BF568637265644D676D74F569636C69656E7450696EF46A6C61726765426C6F6273F56E70696E557641757468546F6B656EF5706D616B654372656455764E6F74527164F5051905140682010207080818460982636E6663637573620A83A263616C672664747970656A7075626C69632D6B6579A263616C672764747970656A7075626C69632D6B6579A263616C67382F64747970656A7075626C69632D6B65790B1910000E18C90F1820');
      var info = Ctap2.parseGetInfoResponse(response);
      expect(info.versions, equals(['U2F_V2', 'FIDO_2_0', 'FIDO_2_1']));
      expect(info.options, contains('rk'));
    });
  });
}
